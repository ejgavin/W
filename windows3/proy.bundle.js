(()=>{"use strict";const e=require("express"),{createProxyMiddleware:t}=require("http-proxy-middleware"),{URL:r}=require("url"),o=e();o.get("/",((e,t)=>{t.send('\n    <h1>Welcome to Proy</h1>\n    <form method="GET" action="/proy">\n      <input type="text" name="destination" placeholder="https://example.com">\n      <button type="submit">Go</button>\n    </form>\n  ')})),o.get("/proy",((e,o,n)=>{const s=e.query.destination;if(!s)return o.status(400).send("Missing destination query parameter.");try{const a=new r(s),i=`${a.protocol}//${a.host}`,c=t({target:i,changeOrigin:!0,pathRewrite:(e,t)=>a.pathname+a.search,onProxyReq(e){e.setHeader("User-Agent","Mozilla/5.0 (Proy)")},onProxyRes(e,t,r){e.headers["X-Frame-Options"]="ALLOWALL",e.headers["Content-Security-Policy"]="default-src *; frame-ancestors *",e.headers["Access-Control-Allow-Origin"]="*";const o=e.headers["set-cookie"];o&&r.setHeader("set-cookie",o)},onError(e,t,r){console.error("Proxy Error: ",e),r.status(500).send("Something went wrong with the proxy.")},logLevel:"debug"});return c(e,o,n)}catch(e){return console.error(e),o.status(400).send("Invalid URL.")}})),o.listen(8080,(()=>{console.log("Advanced Proxy running at http://localhost:8080")}))})();